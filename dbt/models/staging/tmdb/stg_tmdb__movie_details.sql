-- stg_tmdb__movie_details.sql
SELECT
  NULLIF(adult, '')::boolean AS is_adult,
  NULLIF(backdrop_path, '') AS backdrop_path,
  NULLIF(belongs_to_collection, '')::jsonb AS belongs_to_collection,
  NULLIF(budget, '')::integer AS budget,
  NULLIF(genres, '')::jsonb AS genres,
  NULLIF(homepage, '') AS homepage,
  NULLIF(id, '')::integer AS movie_id,
  NULLIF(imdb_id, '') AS imdb_id,
  NULLIF(origin_country, '')::jsonb AS origin_country,
  LOWER(NULLIF(original_language, '')) AS original_language,
  NULLIF(original_title, '') AS original_title,
  NULLIF(overview, '') AS overview,
  NULLIF(popularity, '')::numeric AS popularity,
  NULLIF(poster_path, '') AS poster_path,
  NULLIF(production_companies, '')::jsonb AS production_companies,
  NULLIF(production_countries, '')::jsonb AS production_countries,
  NULLIF(release_date, '')::date AS release_date,
  NULLIF(revenue, '')::bigint AS revenue,
  NULLIF(runtime, '')::integer AS runtime,
  NULLIF(spoken_languages, '')::jsonb AS spoken_languages,
  NULLIF(status, '') AS status,
  NULLIF(tagline, '') AS tagline,
  NULLIF(title, '') AS title,
  NULLIF(video, '')::boolean AS is_video,
  NULLIF(vote_average, '')::numeric(4,2) AS vote_average,
  NULLIF(vote_count, '')::integer AS vote_count
FROM {{ source('raw','movie_details') }}
